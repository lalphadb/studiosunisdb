<?php
// config/telescope.php - CORRECTION DES PATHS

use Laravel\Telescope\Http\Middleware\Authorize;
use Laravel\Telescope\Watchers;

return [
    'enabled' => env('TELESCOPE_ENABLED', true),
    
    'driver' => env('TELESCOPE_DRIVER', 'database'),
    
    'storage' => [
        'database' => [
            'connection' => env('DB_CONNECTION', 'mysql'),
            'chunk' => 1000,
        ],
    ],

    'domain' => env('TELESCOPE_DOMAIN'),
    'path' => env('TELESCOPE_PATH', 'telescope'),

    'middleware' => [
        'web',
        Authorize::class,
    ],

    // ðŸ”§ CORRECTION : Enlever only_paths pour capturer toutes les requÃªtes
    // 'only_paths' => [
    //     'admin/*',
    //     'api/*',
    // ],

    // âŒ Ignorer seulement les chemins inutiles
    'ignore_paths' => [
        'telescope*',
        'vendor/*',
        'nova-api*',
        'pulse*',
        'sanctum*',
        '_debugbar*',
        'livewire*',
        'favicon.ico',
        '*.js',
        '*.css',
        '*.png',
        '*.jpg',
        '*.gif',
        '*.svg',
    ],

    'ignore_commands' => [
        'queue:work',
        'queue:listen',
        'horizon:work',
        'horizon:supervisor',
        'schedule:run',
        'schedule:finish',
    ],

    // ðŸŽ¯ WATCHERS CORRIGÃ‰S POUR STUDIOSUNISDB
    'watchers' => [
        // âœ… EXCEPTIONS - Toujours actif
        Watchers\ExceptionWatcher::class => [
            'enabled' => env('TELESCOPE_EXCEPTION_WATCHER', true),
        ],

        // âœ… LOGS - Erreurs seulement
        Watchers\LogWatcher::class => [
            'enabled' => env('TELESCOPE_LOG_WATCHER', true),
            'level' => 'error',
        ],

        // âœ… REQUÃŠTES - Toutes les requÃªtes
        Watchers\RequestWatcher::class => [
            'enabled' => env('TELESCOPE_REQUEST_WATCHER', true),
            'size_limit' => 64,
            'ignore_http_methods' => [],
            'ignore_status_codes' => [],
        ],

        // âœ… QUERIES - RequÃªtes lentes
        Watchers\QueryWatcher::class => [
            'enabled' => env('TELESCOPE_QUERY_WATCHER', true),
            'ignore_packages' => true,
            'slow' => 100, // RÃ©duire Ã  100ms pour plus de dÃ©tection
        ],

        // âœ… COMMANDS - Commandes Artisan
        Watchers\CommandWatcher::class => [
            'enabled' => env('TELESCOPE_COMMAND_WATCHER', true),
            'ignore' => [
                'schedule:run',
                'schedule:finish',
                'package:discover',
                'config:cache',
                'route:cache',
                'view:cache',
            ],
        ],

        // âœ… JOBS - TÃ¢ches en arriÃ¨re-plan
        Watchers\JobWatcher::class => [
            'enabled' => env('TELESCOPE_JOB_WATCHER', true),
        ],

        // âœ… SCHEDULE - TÃ¢ches planifiÃ©es
        Watchers\ScheduleWatcher::class => [
            'enabled' => env('TELESCOPE_SCHEDULE_WATCHER', true),
        ],

        // âš ï¸ MAIL - Si vous utilisez les emails
        Watchers\MailWatcher::class => [
            'enabled' => env('TELESCOPE_MAIL_WATCHER', true),
        ],

        // âš ï¸ NOTIFICATIONS - Pour les notifications
        Watchers\NotificationWatcher::class => [
            'enabled' => env('TELESCOPE_NOTIFICATION_WATCHER', false),
        ],

        // âŒ CACHE - Trop verbeux, dÃ©sactivÃ©
        Watchers\CacheWatcher::class => [
            'enabled' => env('TELESCOPE_CACHE_WATCHER', false),
        ],

        // âŒ EVENTS - Trop verbeux
        Watchers\EventWatcher::class => [
            'enabled' => env('TELESCOPE_EVENT_WATCHER', false),
        ],

        // âŒ MODELS - Trop verbeux
        Watchers\ModelWatcher::class => [
            'enabled' => env('TELESCOPE_MODEL_WATCHER', false),
        ],

        // âŒ VIEWS - Pas nÃ©cessaire
        Watchers\ViewWatcher::class => [
            'enabled' => env('TELESCOPE_VIEW_WATCHER', false),
        ],

        // âŒ DUMP - Debug seulement
        Watchers\DumpWatcher::class => [
            'enabled' => env('TELESCOPE_DUMP_WATCHER', false),
        ],
    ],
];
